/**
* jQuery asTree v0.3.1
* https://github.com/amazingSurge/jquery-asTree
*
* Copyright (c) amazingSurge
* Released under the LGPL-3.0 license
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof exports)t(require("jquery"));else{var n={exports:{}};t(e.jQuery),e.jqueryAsTreeEs=n.exports}}(this,function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=t(e),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s={namespace:"tree",autoOpen:[1,2],dataFromHtml:!1,data:null,multiSelect:!1,canUnselect:!0,tpl:{toggler:function(e){return'<i class="tree-toggler"></i>'},branch:function(e){var t=this.branchContent(e),n=this.toggler(e);return'<div class="tree-element">'+n+'<div class="element-content">'+t+"</div></div>"},branchContent:function(e){return"object"===("undefined"==typeof e?"undefined":a(e))?e.name:e},leaf:function(e){var t=this.leafContent(e);return t},leafContent:function(e){return"object"===("undefined"==typeof e?"undefined":a(e))?e.name:e}}},l=function(){function e(t){n(this,e),this.tpl=t.tpl}return r(e,[{key:"getLeaf",value:function(e){var t=this.tpl.leaf(e);return"<li>"+t+"</li>"}},{key:"getBranch",value:function(e){var t=this.tpl.branch(e),n=this.getTree(e.children);return'<li class="tree-branch">'+t+n+"</li>"}},{key:"getNode",value:function(e){return e.children?this.getBranch(e):this.getLeaf(e)}},{key:"getTree",value:function(e,t){var n="",i=!0,r=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var o=s.value;n+=this.getNode(o)}}catch(e){r=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return t?'<ul class="tree">'+n+"</ul>":"<ul>"+n+"</ul>"}}]),e}(),o=function(){function e(t,i,r){n(this,e),this.$dom=t,this.api=r,null===i&&(i=!1),i?this.type="root":(this.selected=!1,this.hasChildren()?(this.type="branch",this.opened=this.isOpened()):this.type="leaf"),this.init()}return r(e,[{key:"init",value:function(){switch(this.type){case"root":this._children=this.$dom.get(0).children,this.level=0,this.parent=null,this.$parent=null;break;case"branch":case"leaf":var e=this.$dom.children("ul");e.length>0?this._children=e.get(0).children:this._children=[],this.$parent=this.$dom.parents("li.tree-branch").eq(0),0===this.$parent.length&&(this.$parent=this.$dom.parent()),this.parent=this.$parent.data("node"),this.level=this.parent.level+1}}},{key:"get",value:function(){return this.$dom}},{key:"position",value:function(){var e=[],t=function t(n){e.push(n.$dom.index()+1),n.parent&&"root"!==n.parent.type&&t(n.parent)};return t(this),e.reverse()}},{key:"parents",value:function e(){var e=[],t=function t(n){null!==n.parent&&(e.push(n.parent),t(n.parent))};return t(this),e}},{key:"children",value:function e(){for(var e=[],t=void 0,n=0;n<this._children.length;n++)t=$(this._children[n]).data("node"),t&&e.push(t);return e}},{key:"siblings",value:function e(){for(var e=[],t=this.$dom.siblings(),n=void 0,i=0;i<t.length;i++)n=t.data("node"),n&&e.push(n);return e}},{key:"hasChildren",value:function(){return 0!==this.$dom.children("ul").children("li").length}},{key:"isOpened",value:function(){return"undefined"==typeof this.opened?this.$dom.is(".tree_open"):this.opened}},{key:"open",value:function(e){if(this.opened=!0,this.$dom.addClass("tree_open"),e)for(var t=this.parents(),n=0;n<t.length;n++)"root"!==t[n].type&&t[n].open();return!this.api.options.multiSelect&&this.hasChildrenSelect()&&this.$dom.removeClass("tree_childrenSelected"),this}},{key:"close",value:function(e){if(this.opened=!1,this.$dom.removeClass("tree_open"),e)for(var t=this.children(),n=0;n<t.length;n++)"branch"===t[n].type&&t[n].close(!0);return!this.api.options.multiSelect&&this.hasChildrenSelect()&&this.$dom.addClass("tree_childrenSelected"),this}},{key:"hasChildrenSelect",value:function(){return 0!==this.$dom.find("li.tree_selected").length}},{key:"hasChildrenSelectBranch",value:function(){return 0!==this.api.$element.find("li.tree_childrenSelected").length}},{key:"toggleOpen",value:function(){return this.opened?this.close():this.open(),this}},{key:"toggleSelect",value:function(){return this.selected?this.unselect():this.select(),this}},{key:"select",value:function(){return this.selected=!0,this.$dom.addClass("tree_selected"),this.api.options.multiSelect?this.api.selected.push(this):(this.api.selected&&this.api.selected.unselect(!0),this.api.selected=this),!this.api.options.multiSelect&&this.hasChildrenSelectBranch()&&this.api.$element.find("li.tree_childrenSelected").removeClass("tree_childrenSelected"),this}},{key:"unselect",value:function(e){var t=this;return(this.api.options.canUnselect||e)&&(this.selected=!1,this.$dom.removeClass("tree_selected"),this.api.options.multiSelect?this.api.selected=$.grep(this.api.selected,function(e){return e.$dom!==t.$dom}):this.api.selected=null),this}},{key:"toBranch",value:function(){if("leaf"===this.type){var e=this.$dom.html();this.$dom.addClass("tree-branch"),this.$dom.html(this.api.options.tpl.branch(e)+"<ul></ul>")}return this}},{key:"append",value:function(e){"leaf"===this.type&&this.toBranch();var t=this.api.dataParser.getNode(e),n=$(t).appendTo(this.$dom.children("ul"));return"leaf"===this.type?this.api.attach(this.$dom,!1,this.api):this.api.attach(n,!1,this.api),this}},{key:"prepend",value:function(e){"leaf"===this.type&&this.toBranch();var t=this.api.dataParser.getNode(e),n=$(t).prependTo(this.$dom.children("ul"));return"leaf"===this.type?this.api.attach(this.$dom,!1,this.api):this.api.attach(n,!1,this.api),this}},{key:"after",value:function(e){var t=this.api.dataParser.getNode(e);this.$dom.after(t);var n=this.$dom.next();return this.api.attach(n,!1,this.api),this}},{key:"before",value:function(e){var t=this.api.dataParser.getNode(e);this.$dom.before(t);var n=this.$dom.prev();return this.api.attach(n,!1,this.api),this}},{key:"remove",value:function(){return this.$dom.remove(),this}}]),e}(),h=function(){function e(t){n(this,e),this.tpl=t.tpl}return r(e,[{key:"getLeaf",value:function(e){return e.html()}},{key:"getBranch",value:function(e){return e.children("div").html()}},{key:"renderTree",value:function(e,t,n){var i=this,r=void 0;if(t?(r=e,e.addClass("tree")):r=e.children("ul"),0!==r.length){e.addClass("tree-branch");var a=function(e){e.children("li").each(function(e,t){var r=$(t),a=i.tpl.branch(i.getBranch(r));r.children("div").replaceWith(a),i.renderTree(r,!1,n)})};a(r)}}}]),e}(),u="asTree",c=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,e),this.$element=(0,i.default)(t),this.options=i.default.extend(!0,{},s,r),this.namespace=this.options.namespace,this.dataParser=new l(this.options),this.htmlParser=new h(this.options),this._init()}return r(e,[{key:"_init",value:function(){this.options.dataFromHtml===!0?this._createFromHtml():this._createFromData();var e="ul"===this.$element[0].nodeName.toLowerCase()?this.$element:this.$element.find("ul:first");this.root=e.data("node"),this.options.multiSelect?this.selected=[]:this.selected=null,this.autoOpen(),this.$element.on({click:i.default.proxy(this._click,this)}),this._trigger("ready")}},{key:"_trigger",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=[this].concat(n);this.$element.trigger(u+"::"+e,r),e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});var a="on"+e;"function"==typeof this.options[a]&&this.options[a].apply(this,n)}},{key:"_createFromHtml",value:function(){var e="ul"===this.$element[0].nodeName.toLowerCase()?this.$element:this.$element.find("ul:first");this.htmlParser.renderTree(e,!0,this),this.attach(e,!0,this)}},{key:"_createFromData",value:function(){var e="";this.options.data&&(e=this.dataParser.getTree(this.options.data,!0)),this.$element.html(e),this.attach(this.$element.children("ul"),!0,this)}},{key:"_click",value:function(e){var t=(0,i.default)(e.target).closest(".tree-toggler, li"),n=(0,i.default)(e.target).closest("li"),r=n.data("node");switch(t.attr("class")){case"tree-toggler":r.toggleOpen();break;default:r.toggleSelect()}}},{key:"attach",value:function(e,t,n){var r=this;e.data("node",new o(e,t,n));var a=void 0;if(a=t?e:e.children("ul"),0!==a.length){var s=function(e){e.children("li").each(function(e,t){var a=(0,i.default)(t);r.attach(a,!1,n)})};s(a)}}},{key:"open",value:function(e,t){var n=this.get(e);return n&&n.open(t),this}},{key:"close",value:function(e,t){var n=this.get(e);return n&&n.close(t),this}},{key:"select",value:function(e){var t=this.get(e);return t&&t.select(),this}},{key:"unselect",value:function(e){var t=this.get(e);return t&&t.unselect(),this}},{key:"get",value:function(e){i.default.isArray(e)||(e=[]);try{for(var t=function(e,t){return(0,i.default)(e._children[t]).data("node")},n=this.root,r=0;r<e.length;r++)n=t(n,e[r]-1);return n}catch(e){return null}}},{key:"getRoot",value:function(){return this.root}},{key:"getSelected",value:function(){return this.selected}},{key:"autoOpen",value:function(){var e=this,t=this.root.$dom;switch(a(this.options.autoOpen)){case"boolean":t.find("li").each(function(t,n){var r=(0,i.default)(n),a=r.data("node");e.options.autoOpen===!0&&"branch"===a.type&&a.open()});break;case"number":t.find("li").each(function(t,n){var r=(0,i.default)(n),a=r.data("node");"branch"===a.type&&a.level<=e.options.autoOpen&&a.open()});break;case"object":i.default.isArray(this.options.autoOpen)&&this.get(this.options.autoOpen).open(!0)}}},{key:"append",value:function(e,t){var n=this.get(e);return n&&n.append(t),this}},{key:"prepend",value:function(e,t){var n=this.get(e);return n&&n.prepend(t),this}},{key:"after",value:function(e,t){var n=this.get(e);return n&&n.after(t),this}},{key:"before",value:function(e,t){var n=this.get(e);return n&&n.before(t),this}},{key:"remove",value:function(e){var t=this.get(e);return t&&t.remove(),this}}],[{key:"setDefaults",value:function(e){i.default.extend(!0,s,i.default.isPlainObject(e)&&e)}}]),e}(),d={version:"0.3.1"},f="asTree",p=i.default.fn.asTree,v=function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];if("string"==typeof e){var l=function(){var n=e;if(/^_/.test(n))return{v:!1};if(!/^(get)/.test(n))return{v:t.each(function(){var e=i.default.data(this,f);e&&"function"==typeof e[n]&&e[n].apply(e,r)})};var a=t.first().data(f);return a&&"function"==typeof a[n]?{v:a[n].apply(a,r)}:void 0}();if("object"===("undefined"==typeof l?"undefined":a(l)))return l.v}return this.each(function(){(0,i.default)(this).data(f)||(0,i.default)(this).data(f,new c(this,e))})};i.default.fn.asTree=v,i.default.asTree=i.default.extend({setDefaults:c.setDefaults,noConflict:function(){return i.default.fn.asTree=p,v}},d)});