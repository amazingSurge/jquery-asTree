/**
* jQuery asTree v0.3.2
* https://github.com/amazingSurge/jquery-asTree
*
* Copyright (c) amazingSurge
* Released under the LGPL-3.0 license
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof exports)t(require("jquery"));else{var n={exports:{}};t(e.jQuery),e.jqueryAsTreeEs=n.exports}}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(e){return e&&e.__esModule?e:{default:e}}(e),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a={namespace:"tree",autoOpen:[1,2],dataFromHtml:!1,data:null,multiSelect:!1,canUnselect:!0,tpl:{toggler:function(e){return'<i class="tree-toggler"></i>'},branch:function(e){var t=this.branchContent(e);return'<div class="tree-element">'+this.toggler(e)+'<div class="element-content">'+t+"</div></div>"},branchContent:function(e){return"object"===(void 0===e?"undefined":r(e))?e.name:e},leaf:function(e){return this.leafContent(e)},leafContent:function(e){return"object"===(void 0===e?"undefined":r(e))?e.name:e}}},s=function(){function e(n){t(this,e),this.tpl=n.tpl}return i(e,[{key:"getLeaf",value:function(e){return"<li>"+this.tpl.leaf(e)+"</li>"}},{key:"getBranch",value:function(e){return'<li class="tree-branch">'+this.tpl.branch(e)+this.getTree(e.children)+"</li>"}},{key:"getNode",value:function(e){return e.children?this.getBranch(e):this.getLeaf(e)}},{key:"getTree",value:function(e,t){var n="",i=!0,r=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var o=s.value;n+=this.getNode(o)}}catch(e){r=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return t?'<ul class="tree">'+n+"</ul>":"<ul>"+n+"</ul>"}}]),e}(),l=function(){function e(n,i,r){t(this,e),this.$dom=n,this.api=r,null===i&&(i=!1),i?this.type="root":(this.selected=!1,this.hasChildren()?(this.type="branch",this.opened=this.isOpened()):this.type="leaf"),this.init()}return i(e,[{key:"init",value:function(){switch(this.type){case"root":this._children=this.$dom.get(0).children,this.level=0,this.parent=null,this.$parent=null;break;case"branch":case"leaf":var e=this.$dom.children("ul");e.length>0?this._children=e.get(0).children:this._children=[],this.$parent=this.$dom.parents("li.tree-branch").eq(0),0===this.$parent.length&&(this.$parent=this.$dom.parent()),this.parent=this.$parent.data("node"),this.level=this.parent.level+1}}},{key:"get",value:function(){return this.$dom}},{key:"position",value:function(){var e=[];return function t(n){e.push(n.$dom.index()+1),n.parent&&"root"!==n.parent.type&&t(n.parent)}(this),e.reverse()}},{key:"parents",value:function(){var e=[];return function t(n){null!==n.parent&&(e.push(n.parent),t(n.parent))}(this),e}},{key:"children",value:function(){for(var e=[],t=void 0,n=0;n<this._children.length;n++)(t=$(this._children[n]).data("node"))&&e.push(t);return e}},{key:"siblings",value:function(){for(var e=[],t=this.$dom.siblings(),n=void 0,i=0;i<t.length;i++)(n=t.data("node"))&&e.push(n);return e}},{key:"hasChildren",value:function(){return 0!==this.$dom.children("ul").children("li").length}},{key:"isOpened",value:function(){return void 0===this.opened?this.$dom.is(".tree_open"):this.opened}},{key:"open",value:function(e){if(this.opened=!0,this.$dom.addClass("tree_open"),e)for(var t=this.parents(),n=0;n<t.length;n++)"root"!==t[n].type&&t[n].open();return!this.api.options.multiSelect&&this.hasChildrenSelect()&&this.$dom.removeClass("tree_childrenSelected"),this}},{key:"close",value:function(e){if(this.opened=!1,this.$dom.removeClass("tree_open"),e)for(var t=this.children(),n=0;n<t.length;n++)"branch"===t[n].type&&t[n].close(!0);return!this.api.options.multiSelect&&this.hasChildrenSelect()&&this.$dom.addClass("tree_childrenSelected"),this}},{key:"hasChildrenSelect",value:function(){return 0!==this.$dom.find("li.tree_selected").length}},{key:"hasChildrenSelectBranch",value:function(){return 0!==this.api.$element.find("li.tree_childrenSelected").length}},{key:"toggleOpen",value:function(){return this.opened?this.close():this.open(),this}},{key:"toggleSelect",value:function(){return this.selected?this.unselect():this.select(),this}},{key:"select",value:function(){return this.selected=!0,this.$dom.addClass("tree_selected"),this.api.options.multiSelect?this.api.selected.push(this):(this.api.selected&&this.api.selected.unselect(!0),this.api.selected=this),!this.api.options.multiSelect&&this.hasChildrenSelectBranch()&&this.api.$element.find("li.tree_childrenSelected").removeClass("tree_childrenSelected"),this}},{key:"unselect",value:function(e){var t=this;return(this.api.options.canUnselect||e)&&(this.selected=!1,this.$dom.removeClass("tree_selected"),this.api.options.multiSelect?this.api.selected=$.grep(this.api.selected,function(e){return e.$dom!==t.$dom}):this.api.selected=null),this}},{key:"toBranch",value:function(){if("leaf"===this.type){var e=this.$dom.html();this.$dom.addClass("tree-branch"),this.$dom.html(this.api.options.tpl.branch(e)+"<ul></ul>")}return this}},{key:"append",value:function(e){"leaf"===this.type&&this.toBranch();var t=this.api.dataParser.getNode(e),n=$(t).appendTo(this.$dom.children("ul"));return"leaf"===this.type?this.api.attach(this.$dom,!1,this.api):this.api.attach(n,!1,this.api),this}},{key:"prepend",value:function(e){"leaf"===this.type&&this.toBranch();var t=this.api.dataParser.getNode(e),n=$(t).prependTo(this.$dom.children("ul"));return"leaf"===this.type?this.api.attach(this.$dom,!1,this.api):this.api.attach(n,!1,this.api),this}},{key:"after",value:function(e){var t=this.api.dataParser.getNode(e);this.$dom.after(t);var n=this.$dom.next();return this.api.attach(n,!1,this.api),this}},{key:"before",value:function(e){var t=this.api.dataParser.getNode(e);this.$dom.before(t);var n=this.$dom.prev();return this.api.attach(n,!1,this.api),this}},{key:"remove",value:function(){return this.$dom.remove(),this}}]),e}(),o=function(){function e(n){t(this,e),this.tpl=n.tpl}return i(e,[{key:"getLeaf",value:function(e){return e.html()}},{key:"getBranch",value:function(e){return e.children("div").html()}},{key:"renderTree",value:function(e,t,n){var i=this,r=void 0;if(t?(r=e,e.addClass("tree")):r=e.children("ul"),0!==r.length){e.addClass("tree-branch");!function(e){e.children("li").each(function(e,t){var r=$(t),a=i.tpl.branch(i.getBranch(r));r.children("div").replaceWith(a),i.renderTree(r,!1,n)})}(r)}}}]),e}(),h=function(){function e(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,e),this.$element=(0,n.default)(i),this.options=n.default.extend(!0,{},a,r),this.namespace=this.options.namespace,this.dataParser=new s(this.options),this.htmlParser=new o(this.options),this._init()}return i(e,[{key:"_init",value:function(){!0===this.options.dataFromHtml?this._createFromHtml():this._createFromData();var e="ul"===this.$element[0].nodeName.toLowerCase()?this.$element:this.$element.find("ul:first");this.root=e.data("node"),this.options.multiSelect?this.selected=[]:this.selected=null,this.autoOpen(),this.$element.on({click:n.default.proxy(this._click,this)}),this._trigger("ready")}},{key:"_trigger",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=[this].concat(n);this.$element.trigger("asTree::"+e,r);var a="on"+(e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}));"function"==typeof this.options[a]&&this.options[a].apply(this,n)}},{key:"_createFromHtml",value:function(){var e="ul"===this.$element[0].nodeName.toLowerCase()?this.$element:this.$element.find("ul:first");this.htmlParser.renderTree(e,!0,this),this.attach(e,!0,this)}},{key:"_createFromData",value:function(){var e="";this.options.data&&(e=this.dataParser.getTree(this.options.data,!0)),this.$element.html(e),this.attach(this.$element.children("ul"),!0,this)}},{key:"_click",value:function(e){var t=(0,n.default)(e.target).closest(".tree-toggler, li"),i=(0,n.default)(e.target).closest("li").data("node");switch(t.attr("class")){case"tree-toggler":i.toggleOpen();break;default:i.toggleSelect()}}},{key:"attach",value:function(e,t,i){var r=this;e.data("node",new l(e,t,i));var a=void 0;if(0!==(a=t?e:e.children("ul")).length){!function(e){e.children("li").each(function(e,t){var a=(0,n.default)(t);r.attach(a,!1,i)})}(a)}}},{key:"open",value:function(e,t){var n=this.get(e);return n&&n.open(t),this}},{key:"close",value:function(e,t){var n=this.get(e);return n&&n.close(t),this}},{key:"select",value:function(e){var t=this.get(e);return t&&t.select(),this}},{key:"unselect",value:function(e){var t=this.get(e);return t&&t.unselect(),this}},{key:"get",value:function(e){n.default.isArray(e)||(e=[]);try{for(var t=this.root,i=0;i<e.length;i++)t=function(e,t){return(0,n.default)(e._children[t]).data("node")}(t,e[i]-1);return t}catch(e){return null}}},{key:"getRoot",value:function(){return this.root}},{key:"getSelected",value:function(){return this.selected}},{key:"autoOpen",value:function(){var e=this,t=this.root.$dom;switch(r(this.options.autoOpen)){case"boolean":t.find("li").each(function(t,i){var r=(0,n.default)(i).data("node");!0===e.options.autoOpen&&"branch"===r.type&&r.open()});break;case"number":t.find("li").each(function(t,i){var r=(0,n.default)(i).data("node");"branch"===r.type&&r.level<=e.options.autoOpen&&r.open()});break;case"object":n.default.isArray(this.options.autoOpen)&&this.get(this.options.autoOpen).open(!0)}}},{key:"append",value:function(e,t){var n=this.get(e);return n&&n.append(t),this}},{key:"prepend",value:function(e,t){var n=this.get(e);return n&&n.prepend(t),this}},{key:"after",value:function(e,t){var n=this.get(e);return n&&n.after(t),this}},{key:"before",value:function(e,t){var n=this.get(e);return n&&n.before(t),this}},{key:"remove",value:function(e){var t=this.get(e);return t&&t.remove(),this}}],[{key:"setDefaults",value:function(e){n.default.extend(!0,a,n.default.isPlainObject(e)&&e)}}]),e}(),u={version:"0.3.2"},c=n.default.fn.asTree,d=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];if("string"==typeof e){var a=e;if(/^_/.test(a))return!1;if(!/^(get)/.test(a))return this.each(function(){var e=n.default.data(this,"asTree");e&&"function"==typeof e[a]&&e[a].apply(e,i)});var s=this.first().data("asTree");if(s&&"function"==typeof s[a])return s[a].apply(s,i)}return this.each(function(){(0,n.default)(this).data("asTree")||(0,n.default)(this).data("asTree",new h(this,e))})};n.default.fn.asTree=d,n.default.asTree=n.default.extend({setDefaults:h.setDefaults,noConflict:function(){return n.default.fn.asTree=c,d}},u)});
//# sourceMappingURL=jquery-asTree.min.js.map
